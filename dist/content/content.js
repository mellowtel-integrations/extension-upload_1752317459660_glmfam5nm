chrome.runtime.onMessage.addListener((e,r,o)=>{if("scanOrders"===e.action){console.log("Scanning orders on the page...");const e=function(){const e=document.querySelectorAll(".order-card, .js-order-card"),r=[];return e.forEach(e=>{const o=e.querySelector(".order-header .a-col-right .a-size-base"),t=e.querySelector(".order-header .a-col-left .a-size-base"),n=e.querySelector('a[href*="invoice"]');if(o&&t&&n){const e=o.innerText.trim().replace("Order #","").trim(),s=t.innerText.trim().replace("Order Placed:","").trim(),c=n.href;r.push({id:e,date:s,invoiceUrl:c,status:"pending"})}}),r}();console.log(`Found ${e.length} orders.`),chrome.runtime.sendMessage({action:"storeOrders",orders:e},r=>{chrome.runtime.lastError?console.error("Error sending message:",chrome.runtime.lastError):(console.log(r.status),chrome.runtime.sendMessage({action:"updateCounts",detectedOrders:e.length}),chrome.runtime.sendMessage({action:"updateStatus",text:`Scan Complete: ${e.length} orders found.`}))})}});